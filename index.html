<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>RicoBet ‚Ä¢ Spins Of Glory</title>
<meta name="theme-color" content="#121125" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

<style>
  :root{
    --bg-image: url("https://ricobr.ft-crm.com/media-api/serve/85c9bc7e-50c8-46fb-933c-359f7c0f9767_1.jpg");
    --bg:#0f1129; --card:#121125; --ring:#2a2e58;
    --tx:#f2f3ff; --mut:#c7cbff; --g1:#ff6ec4; --g2:#7873f5; --a3:#78f3ff;
    --row-h:56px;
    --c1:#ffd84a; --c2:#dfe6ff; --c3:#ffc19b;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    background:
      radial-gradient(1200px 600px at 10% -10%,rgba(255,110,196,.10),transparent),
      radial-gradient(900px 500px at 100% 110%,rgba(120,115,245,.10),transparent),
      var(--bg-image), var(--bg);
    background-size: auto, auto, cover, auto;
    background-position:center;
    background-attachment: fixed, fixed, fixed, fixed;
    color:var(--tx);
    font:14px/1.45 Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,Helvetica,sans-serif
  }
  .wrap{max-width:1080px; margin:24px auto 46px; padding:0 16px}

  .topbar{display:flex; justify-content:center; align-items:center; margin-bottom:12px}
  .logo-img{height:36px;width:auto;display:block}
  @media (max-width:520px){ .logo-img{height:28px} }

  .card{position:relative; border:1px solid var(--ring); border-radius:18px; background:rgba(18,17,37,.86)}
  .glow::before{
    content:""; position:absolute; inset:-2px; border-radius:20px; padding:2px;
    background:linear-gradient(90deg,var(--g1),var(--g2),var(--a3),var(--g1)); background-size:400% 100%;
    -webkit-mask:linear-gradient(#000 0 0) content-box,linear-gradient(#000 0 0);
    -webkit-mask-composite:xor; mask-composite:exclude; animation:shine 9s linear infinite; pointer-events:none;
  }
  @keyframes shine{0%{background-position:0% 0}100%{background-position:400% 0}}

  /* ===== HERO ===== */
  .hero.card{padding:18px; text-align:center}
  .title-3d{
    margin:2px 0 4px; font-weight:900; letter-spacing:.4px; color:#fff;
    text-shadow:
      0 1px 0 #c9c9ff, 0 2px 0 #b6b6ff, 0 3px 0 #a3a3ff, 0 4px 0 #9090ff,
      0 10px 20px rgba(0,0,0,.35), 0 0 24px rgba(120,115,245,.45);
    filter: drop-shadow(0 6px 12px rgba(0,0,0,.25));
    animation:floaty 5s ease-in-out infinite;
    font-size:42px; line-height:1.05;
  }
  @keyframes floaty{0%,100%{transform:translateY(0)}50%{transform:translateY(-2px)}}
  @media (max-width:720px){ .title-3d{font-size:34px} }
  @media (max-width:520px){ .title-3d{font-size:28px} }
  .hero-subtitle{
    margin:6px auto 8px; font-weight:800; font-size:18px;
    background:linear-gradient(90deg,var(--g1),var(--a3),var(--g2),var(--g1));
    -webkit-background-clip:text; background-clip:text; color:transparent;
    background-size:300% 100%; animation:shine 6s linear infinite
  }
  @media (max-width:520px){ .hero-subtitle{font-size:16px} }
  .sub{margin:12px 0 0; color:var(--mut)}

  /* COUNTDOWN */
  .ring-row{display:flex; justify-content:center; margin-top:10px}
  .ring-timer{display:flex;gap:16px;align-items:center;padding:10px 12px;border-radius:14px;
    background:#161733;border:1px solid rgba(255,255,255,.15);box-shadow:0 10px 30px rgba(0,0,0,.25)}
  .ring{position:relative;width:92px;height:92px;display:grid;place-items:center}
  .ring svg{width:92px;height:92px;transform:rotate(-90deg)}
  .ring .bg{fill:none;stroke:rgba(255,255,255,.12);stroke-width:8}
  .ring .fg{fill:none;stroke:url(#ring-grad);stroke-width:8;stroke-linecap:round;filter:drop-shadow(0 0 8px rgba(120,115,245,.5))}
  .value{position:absolute;font-weight:900;font-size:22px;letter-spacing:.5px;transition:transform .25s ease}
  .value.bump{transform:translateY(-3px)}
  .ring .label{position:absolute;bottom:8px;font-size:10px;color:#c7cbff;letter-spacing:.35px}
  @media (max-width:520px){ .ring{width:78px;height:78px} .ring svg{width:78px;height:78px} .value{font-size:18px} }

  /* ===== CARTOON PODIUM (TOP 3) ===== */
  .podium{
    display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px;align-items:end;margin:14px 0 2px
  }
  .pod{
    position:relative;border-radius:18px;text-align:center;padding:16px 10px 22px;
    background:linear-gradient(180deg,rgba(255,255,255,.10),rgba(255,255,255,.03));
    border:2px solid rgba(255,255,255,.28); box-shadow:0 16px 30px rgba(0,0,0,.40);
  }
  .pod--1{transform:translateY(-14px);background:linear-gradient(180deg,#3a2f6b,#211e46)}
  /* block numbers (1/2/3) */
  .pod::after{
    content:attr(data-ped); position:absolute; left:50%; transform:translateX(-50%); bottom:-16px;
    width:56px; height:36px; border-radius:12px; display:grid; place-items:center;
    font-weight:900; font-size:18px; color:#1a1b33; letter-spacing:.2px;
    border:2px solid rgba(255,255,255,.45); box-shadow:0 10px 18px rgba(0,0,0,.45);
    background:var(--ped,#ffd84a);
  }
  .pod--1{ --ped:var(--c1) }  .pod--2{ --ped:var(--c2) }  .pod--3{ --ped:var(--c3) }

  /* rank chip (kept tiny, like reference numbers) */
  .pod-rank{
    position:absolute; top:8px; left:8px;
    display:inline-flex;align-items:center;justify-content:center;min-width:36px;height:26px;padding:0 10px;
    border-radius:999px;font-weight:900;border:2px solid rgba(255,255,255,.35);box-shadow:0 2px 0 rgba(0,0,0,.35);
    background:rgba(255,255,255,.9); color:#1b1b38;
  }

  /* NEW: Trophy badge */
  .trophy{
    position:absolute; top:-14px; right:-10px; width:64px; height:64px; border-radius:16px;
    display:grid; place-items:center; font-size:28px; font-weight:900; color:#1b1b38;
    transform:rotate(-8deg); box-shadow:0 10px 18px rgba(0,0,0,.45);
    border:3px solid rgba(255,255,255,.6);
    background:var(--tbg);
    animation:wobble 2.4s ease-in-out infinite;
  }
  .t1{ --tbg: linear-gradient(135deg,#fff6b5,#ffd84a) } /* gold */
  .t2{ --tbg: linear-gradient(135deg,#f4f6ff,#dbe3ff) } /* silver */
  .t3{ --tbg: linear-gradient(135deg,#ffe0c9,#ffb07a) } /* bronze */
  .trophy::after{ content:"üèÜ"; filter:drop-shadow(0 2px 0 rgba(0,0,0,.25)); }
  @keyframes wobble{0%,100%{transform:rotate(-8deg) translateY(0)}50%{transform:rotate(6deg) translateY(-4px)}}

  /* Avatar only (no sticker) */
  .pod-avatar{
    width:88px;height:88px;border-radius:22px;margin:16px auto 8px;
    background:linear-gradient(135deg,var(--g2),var(--a3));background-size:cover;background-position:center;
    border:4px solid rgba(255,255,255,.65); box-shadow:0 8px 16px rgba(0,0,0,.35);
  }
  .pod-name{font-weight:900;letter-spacing:.2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .pod-amt{margin-top:2px;font-weight:900;font-variant-numeric:tabular-nums}

  /* keep 3 columns on mobile */
  @media (max-width:520px){
    .podium{grid-template-columns:1fr 1fr 1fr}
    .pod--1{transform:translateY(-10px)}
    .pod-avatar{width:70px;height:70px;border-width:3px;margin:12px auto 6px}
    .pod::after{width:48px;height:30px;font-size:16px;bottom:-12px}
    .trophy{width:54px;height:54px}
  }

  /* ===== LIST (#4‚Äì#20), cute badges ===== */
  .panel.card{padding:14px}
  .panel-head{display:flex; flex-wrap:wrap; gap:10px; justify-content:space-between; align-items:center; margin-bottom:8px}
  .title{margin:0; font-size:18px; display:flex; align-items:center; gap:8px; flex-wrap:wrap}
  .filters{display:flex; gap:8px; flex-wrap:wrap}
  .chip{display:inline-flex; align-items:center; gap:6px; padding:8px 10px; border-radius:10px; font-size:12px; color:#fff;
        background:#1b1c33; border:1px solid rgba(255,255,255,.12)}
  .chip button{all:unset; cursor:pointer}

  .board-wrap{overflow:hidden}
  .board{width:100%; border-radius:14px; overflow:hidden; border:1px solid rgba(255,255,255,.08)}
  .row{
    display:grid; grid-template-columns:88px 1fr 180px; gap:10px; align-items:center;
    padding:12px 12px; background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));
    border-bottom:1px solid rgba(255,255,255,.06)
  }
  .row.head{background:rgba(255,255,255,.08); font-weight:900; color:#dfe3ff}
  .row:last-child{border-bottom:none}
  .rank{
    display:inline-flex;align-items:center;justify-content:center;min-width:56px;height:36px;padding:0 12px;
    border-radius:18px;background:linear-gradient(180deg,#2c2b56,#1b1b38);
    border:2px solid rgba(255,255,255,.28); font-weight:900; box-shadow:0 3px 0 rgba(0,0,0,.35)
  }
  .player{display:flex; align-items:center; gap:10px; min-width:0}
  .avatar{
    width:36px;height:36px;border-radius:12px;background:linear-gradient(135deg,var(--g2),var(--a3));
    background-size:cover;background-position:center;border:2px solid rgba(255,255,255,.35); box-shadow:0 3px 0 rgba(0,0,0,.35)
  }
  .mask{flex:1 1 auto; font-weight:900; letter-spacing:.2px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; font-size:13px}
  .payout{font-variant-numeric:tabular-nums; font-weight:900; text-align:right}
  @media (max-width:560px){ .row{grid-template-columns:74px 1fr 132px; padding:10px} .mask{font-size:12px} }

  /* Show only 5 rows before scroll */
  .viewport{max-height:calc(var(--row-h) * 5); overflow-y:auto}
  .viewport::-webkit-scrollbar{height:8px;width:8px}
  .viewport::-webkit-scrollbar-thumb{background:#2b2d4e;border-radius:10px}
  .hit{outline:2px solid var(--a3); border-radius:8px}

  .search-wrap{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
  .search-input{appearance:none; background:#141534; border:1px solid rgba(255,255,255,.15); color:#fff;
    border-radius:10px; padding:8px 10px; min-width:220px; outline:none}
  .search-btn{cursor:pointer; background:linear-gradient(90deg,var(--g1),var(--g2)); border:0; color:#fff;
    font-weight:900; border-radius:10px; padding:8px 12px}

  .cta-row{margin-top:18px; display:flex; gap:12px; flex-wrap:wrap; justify-content:center; align-items:center}
  .btn{display:inline-flex; align-items:center; gap:8px; padding:12px 18px; border-radius:12px; text-decoration:none;
      font-weight:800; font-size:14px; color:#fff; border:1px solid rgba(255,255,255,.25); transition:transform .15s ease}
  .btn:hover{transform:translateY(-2px)}
  .btn--pri{background:linear-gradient(90deg,var(--g1),var(--g2)); box-shadow:0 0 0 0 rgba(120,115,245,.55); animation:pulse 2.4s ease-in-out infinite}
  @keyframes pulse{0%{box-shadow:0 0 0 0 rgba(120,115,245,.55)}70%{box-shadow:0 0 0 18px rgba(120,115,245,0)}100%{box-shadow:0 0 0 0 rgba(120,115,245,0)}}
  .btn--dark{background:#1a1b34}

  .support{margin-top:10px; text-align:center; color:#cfd3ff; text-shadow: 0 1px 0 rgba(0,0,0,.8), 0 6px 18px rgba(0,0,0,.35)}
  .support a{color:#a5b0ff; font-weight:800; text-decoration:underline}

  .sharebar{margin-top:18px; display:flex; align-items:center; justify-content:space-between; gap:12px;
    padding:14px 16px; border-radius:14px; background:#0f216a; border:1px solid #2c3ea0; color:#fff; box-shadow:0 10px 25px rgba(0,0,0,.25)}
  .sharebar b{font-size:18px; letter-spacing:.5px; text-shadow:0 2px 0 rgba(0,0,0,.35)}
  .share-actions{display:flex; gap:10px}
  .sharebtn{display:inline-flex; align-items:center; justify-content:center; width:42px; height:42px; border-radius:999px; background:#142b90; border:1px solid rgba(255,255,255,.18); text-decoration:none; transition:transform .15s ease}
  .sharebtn:hover{transform:translateY(-2px)}
  .tg{background:#229ED9} .wa{background:#25D366}
  .divider{height:1px; margin:26px 0 8px; background:linear-gradient(90deg,transparent,#394080,transparent)}

  /* ===== FAQ (no number pills) ===== */
  .faq-panel{border-radius:18px; overflow:hidden}
  .faq-panel > summary{list-style:none; cursor:pointer; padding:14px 16px; font-weight:900; font-size:16px; background:#17183a; color:#fff; display:flex; align-items:center; justify-content:space-between}
  .faq-panel > summary::after{content:"‚ñæ"; opacity:.9; transition:transform .2s ease}
  .faq-panel[open] > summary::after{ transform:rotate(180deg) }
  .faq-body{padding:12px 14px; max-height:60vh; overflow:auto; background:#0f1030}
  .faq-item{background:#141534; border:1px solid rgba(255,255,255,.12); border-radius:12px; padding:10px 12px; margin:8px 0; box-shadow:0 8px 24px rgba(0,0,0,.2)}
  .faq-item > summary{cursor:pointer; font-weight:800}
  .faq-item p{margin:8px 0 0 0; color:#dfe3ff}
</style>
</head>
<body>
  <div class="wrap">
    <div class="topbar" aria-label="RicoBet">
      <img src="https://ricobr.ft-crm.com/media-api/serve/c5570255-af15-4915-8b16-907d5bc7f999_Rico_Logo.png" alt="RicoBet" class="logo-img" />
    </div>

    <!-- HERO -->
    <section class="hero card glow">
      <h1 class="title-3d">Spins Of Glory</h1>
      <div class="hero-subtitle">Daily Prizes of USD 5,000</div>

      <div class="ring-row">
        <div class="ring-timer" aria-label="Countdown to midnight (Brazil)">
          <div class="ring" data-unit="h">
            <svg viewBox="0 0 72 72" aria-hidden="true">
              <defs><linearGradient id="ring-grad" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" stop-color="#ff6ec4"/><stop offset="100%" stop-color="#7873f5"/></linearGradient></defs>
              <circle class="bg" cx="36" cy="36" r="30"></circle>
              <circle class="fg" cx="36" cy="36" r="30"></circle>
            </svg>
            <div class="value">00</div><div class="label">HRS</div>
          </div>
          <div class="ring" data-unit="m">
            <svg viewBox="0 0 72 72" aria-hidden="true">
              <circle class="bg" cx="36" cy="36" r="30"></circle>
              <circle class="fg" cx="36" cy="36" r="30"></circle>
            </svg>
            <div class="value">00</div><div class="label">MIN</div>
          </div>
          <div class="ring" data-unit="s">
            <svg viewBox="0 0 72 72" aria-hidden="true">
              <circle class="bg" cx="36" cy="36" r="30"></circle>
              <circle class="fg" cx="36" cy="36" r="30"></circle>
            </svg>
            <div class="value">00</div><div class="label">SEC</div>
          </div>
        </div>
      </div>
      <p class="sub">Play in Pragmatic Play Slot Games to win the daily prizes !</p>
    </section>

    <!-- WINNERS -->
    <section class="panel card glow" style="margin-top:18px">
      <div class="panel-head">
        <h2 class="title">üèÜ Top 20 ‚Ä¢ <span id="boardDate">‚Äî</span></h2>
        <div class="filters">
          <span class="chip">üß≠ Last update: <b id="lastUpdated">‚Äî</b></span>
          <span class="chip"><button id="refresh">‚ü≥ Refresh</button></span>
          <label class="chip" title="Pick a date">üìÖ&nbsp;<input id="datePicker" type="date" style="background:transparent;border:0;color:#fff;outline:none"></label>
          <span class="chip" id="quickToday" style="cursor:pointer">üìÜ Today</span>
          <span class="chip" id="quickYesterday" style="cursor:pointer">üóìÔ∏è Yesterday</span>
        </div>
      </div>

      <!-- Podium -->
      <div id="podium" class="podium" aria-live="polite"></div>

      <!-- List starts at #4 -->
      <div class="board-wrap">
        <div class="board">
          <div class="row head">
            <div>#</div><div>Player</div><div style="text-align:right">Turnover</div>
          </div>
          <div id="rows" class="viewport" aria-live="polite"></div>
        </div>
      </div>
    </section>

    <!-- CTAs -->
    <div class="cta-row">
      <a class="btn btn--pri" href="https://www.rico.bet/" target="_blank" rel="noopener">‚ñ∂ PLAY NOW</a>
      <a class="btn btn--dark" href="https://t.me/+55A937ipq8xhMzJl" target="_blank" rel="noopener">üë• JOIN COMMUNITY</a>
    </div>
    <p class="support">Need help? Message our support on Telegram and we‚Äôll assist you: <a href="https://t.me/+55A937ipq8xhMzJl" target="_blank" rel="noopener">Contact Support</a></p>

    <div class="divider"></div>

    <!-- FAQ (no numbered pills) -->
    <details class="faq-panel card glow">
      <summary>FAQ &amp; Terms</summary>
      <div class="faq-body">
        <details id="q1" class="faq-item"><summary>1. What is this event about?</summary>
          <p>Daily leaderboard on Pragmatic Play slots. Higher turnover = higher rank = bigger prize.</p>
        </details>
        <details id="q2" class="faq-item"><summary>2. How do I participate?</summary>
          <p>Play any Pragmatic Play slot during the event. Your turnover is tracked automatically.</p>
        </details>
        <details id="q3" class="faq-item"><summary>3. How are prizes distributed?</summary>
          <p>Top 20 share the $5,000 daily pool. 1st: $1,500 ‚Ä¢ 2‚Äì5: $500 ‚Ä¢ 6‚Äì10: $200 ‚Ä¢ 11‚Äì20: $50.</p>
        </details>
        <details id="q4" class="faq-item"><summary>4. Total prize pool?</summary>
          <p>$150,000 across the month.</p>
        </details>
        <details id="q5" class="faq-item"><summary>5. When does the leaderboard reset?</summary>
          <p>00:00 (Brazil local time) daily.</p>
        </details>
        <details id="q6" class="faq-item"><summary>6. How do I see my rank?</summary>
          <p>Use the live board here. If not in Top 20, search your username to see your current rank.</p>
        </details>
        <details id="q7" class="faq-item"><summary>7. When are prizes paid?</summary>
          <p>Next day, 12:00 PM local time.</p>
        </details>
        <details id="q8" class="faq-item"><summary>8. Ties?</summary>
          <p>Earliest to reach the amount ranks higher.</p>
        </details>
        <details id="q9" class="faq-item"><summary>9. Can I win multiple days?</summary>
          <p>Yes‚Äîevery day is a new chance.</p>
        </details>
        <details id="q10" class="faq-item"><summary>10. What counts?</summary>
          <p>Turnover from Pragmatic Play slots (cash and bonus). Others don‚Äôt count.</p>
        </details>
        <details id="q11" class="faq-item"><summary>11. Who‚Äôs eligible?</summary>
          <p>All players wagering on Pragmatic Play slots.</p>
        </details>
        <details id="q12" class="faq-item"><summary>12. Wagering on prizes?</summary>
          <p>Cash prizes: x1 wagering.</p>
        </details>
        <details id="q13" class="faq-item"><summary>13. Exchange prizes?</summary>
          <p>No. Prizes are non-transferable.</p>
        </details>
        <details id="q14" class="faq-item"><summary>14. Terms</summary>
          <p>Fraud/multi-accounting voids rewards. General Rico.bet T&amp;Cs apply.</p>
        </details>
      </div>
    </details>
  </div>

<script>
/* ===== CONFIG ===== */
const DATA_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRmj-_miuOyDdV2cshF2M_g6aaVcNqtChyeg5PII28oaWQHPFVPiQzogRBLOATha5ug0Vh2t6HUgIIP/pub?output=csv";
const EVENT_START_YMD  = "2025-09-23";
const EVENT_END_YMD    = "2025-10-31";
const CURRENT_TZ = "America/Sao_Paulo";
const CURRENCY = { symbol: "$", code: "USD" };

/* ===== Elements ===== */
const $ = s=>document.querySelector(s);
const rowsEl = $('#rows'), podiumEl = $('#podium'), updatedEl = $('#lastUpdated'), boardDateEl = $('#boardDate');
const datePicker = $('#datePicker');

/* ===== Helpers ===== */
const fmtMoney = n => `${CURRENCY.symbol} ${Number(n||0).toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:2})}`;
const pad2 = n => String(n).padStart(2,'0');
const toTZ = (d=new Date(), tz=CURRENT_TZ, opts={}) => new Intl.DateTimeFormat('en-CA', { timeZone: tz, ...opts });
const ymdInTZ = d => toTZ(d, CURRENT_TZ, {year:'numeric',month:'2-digit',day:'2-digit'}).format(d);
const cmpYmd = (a,b)=>a.localeCompare(b);
const clampYmd = ymd => cmpYmd(ymd,EVENT_START_YMD)<0?EVENT_START_YMD : cmpYmd(ymd,EVENT_END_YMD)>0?EVENT_END_YMD : ymd;

/* ===== CSV loader & leaderboard (Avatar URL optional in column 5) ===== */
let cache = [];
async function loadCSV(){
  const url = DATA_CSV_URL + (DATA_CSV_URL.includes('?')?'&':'?') + 't=' + Date.now();
  const res = await fetch(url, {cache:'no-store'});
  if(!res.ok) throw new Error('CSV fetch failed');
  const text = await res.text();

  const lines = text.split(/\r?\n/).filter(Boolean);
  const out = [];
  for (let i=1;i<lines.length;i++){
    const raw = lines[i].split(',');
    if (raw.length < 3) continue;
    const date = raw[0].trim();
    const rank = Number(raw[1]?.trim() || 0);
    const username = (raw[2]||'').trim();
    const turnover = Number(String(raw[3]||'0').replace(/[$,\s]/g,''));  // numeric
    const avatar = (raw[4]||'').trim(); // optional
    if (!date || !username) continue;
    out.push({date, rank, name: username, amount: isNaN(turnover)?0:turnover, avatar});
  }
  cache = out;

  const updated = new Intl.DateTimeFormat('en-US',{
    timeZone: CURRENT_TZ, year:'numeric',month:'numeric',day:'numeric',
    hour:'numeric',minute:'2-digit',second:'2-digit'
  }).format(new Date());
  updatedEl.textContent = updated;
}
function maskUsername(name){
  const s = String(name||'');
  if(s.length<=6){ const keep=Math.max(1,Math.floor(s.length/3)); return `${s.slice(0,keep)}****${s.slice(-keep)}`; }
  const left=Math.floor((s.length-4)/2); return s.slice(0,left)+'****'+s.slice(left+4);
}
function bust(url){
  if(!url) return '';
  const sep = url.includes('?') ? '&' : '?';
  return `${url}${sep}v=${Date.now()}`; // cache-buster for avatar updates
}
function avatarStyle(url){ return url ? `style="background-image:url('${bust(url)}');"` : ""; }

/* Build podium card */
function trophyClass(rank){
  if(rank===1) return 'trophy t1';
  if(rank===2) return 'trophy t2';
  return 'trophy t3';
}

function renderDay(ymd){
  boardDateEl.textContent = ymd;
  rowsEl.innerHTML = '';
  podiumEl.innerHTML = '';

  const dayRows = cache.filter(r=>r.date===ymd);
  if (!dayRows.length){
    rowsEl.innerHTML = `<div class="row"><div></div><div>No results for ${ymd}.</div><div></div></div>`;
    return;
  }
  const withRank = dayRows.some(r=>r.rank>0);
  const sorted = dayRows.slice().sort((a,b)=>{
    if(withRank){
      const ar = a.rank||99999, br = b.rank||99999;
      return ar - br;
    }
    return (b.amount||0)-(a.amount||0);
  });

  // Podium 1‚Äì3 (center = #1, left = #2, right = #3)
  const top3 = sorted.slice(0,3);
  const order = [1,0,2];
  order.forEach((i)=>{
    const r = top3[i]; if(!r) return;
    const cls = i===0?'pod--1' : i===1?'pod--2':'pod--3';
    const shownRank = withRank ? (r.rank || i+1) : (i+1);
    const trophy = `<div class="${trophyClass(shownRank)}" aria-hidden="true"></div>`;
    podiumEl.insertAdjacentHTML('beforeend', `
      <div class="pod ${cls}" data-ped="${i+1}">
        <div class="pod-rank">#${shownRank}</div>
        ${trophy}
        <div class="pod-avatar" ${avatarStyle(r.avatar)}></div>
        <div class="pod-name">${maskUsername(r.name)}</div>
        <div class="pod-amt">${fmtMoney(r.amount)}</div>
      </div>
    `);
  });

  // List 4‚Äì20 (viewport shows only 5 rows)
  const rest = sorted.slice(3,20);
  rest.forEach((r, idx)=>{
    const rankShown = withRank ? (r.rank||idx+4) : (idx+4);
    const row = document.createElement('div');
    row.className='row';
    row.dataset.nameOriginal = r.name;
    row.innerHTML = `
      <div><span class="rank">#${rankShown}</span></div>
      <div class="player">
        <span class="avatar" ${avatarStyle(r.avatar)} aria-hidden="true"></span>
        <span class="mask">${maskUsername(r.name)}</span>
      </div>
      <div class="payout">${fmtMoney(r.amount)}</div>`;
    rowsEl.appendChild(row);
  });
}

async function refreshFor(ymd){ await loadCSV(); renderDay(ymd); }

/* ===== INIT ===== */
(async function init(){
  datePicker.min = EVENT_START_YMD; datePicker.max = EVENT_END_YMD;
  const today = clampYmd( ymdInTZ(new Date()) );
  datePicker.value = today;

  await refreshFor(today);

  document.getElementById('refresh').addEventListener('click', async (e)=>{ e.preventDefault(); await refreshFor(datePicker.value); });
  datePicker.addEventListener('change', ()=> renderDay(clampYmd(datePicker.value)));
  document.getElementById('quickToday').addEventListener('click', async ()=>{ const y = clampYmd( ymdInTZ(new Date()) ); datePicker.value=y; await refreshFor(y); });
  document.getElementById('quickYesterday').addEventListener('click', async ()=>{ const n = new Date(); n.setDate(n.getDate()-1); const y = clampYmd( ymdInTZ(n) ); datePicker.value=y; await refreshFor(y); });

  // (Optional) search controls if you add them back later.
})();
</script>
</body>
</html>
